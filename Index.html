<!DOCTYPE html><html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Avaliação de Empresas Jovens com Python — Implementação Prática do FCD | Standalone com Pyodide</title>
  <meta name="description" content="Página standalone com execução de Python no navegador via Pyodide para implementação prática de FCD para empresas jovens, sem depender do Google Colab." />  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0b1220;--panel:#111a2b;--panel-2:#0f1626;--muted:#b9c2d0;--text:#e8eefc;--accent:#4ea1ff;--ok:#33d17a;--warn:#f6c644;--err:#ff6b6b;--mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    html,body{background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;line-height:1.6}
    .wrap{max-width:1100px;margin:0 auto;padding:32px 16px}
    h1,h2,h3{line-height:1.25}
    h1{font-size:2rem;margin:0 0 1rem}
    h2{font-size:1.35rem;margin-top:2rem}
    h3{font-size:1.05rem;margin-top:1.5rem;color:var(--muted)}
    p,li{color:#d7e2f4}
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
    .panel{background:linear-gradient(180deg,var(--panel),var(--panel-2));border:1px solid rgba(255,255,255,.08);border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .pad{padding:18px}
    .grid{display:grid;gap:18px}
    .notice{border-left:4px solid var(--accent);padding:12px 14px;background:rgba(78,161,255,.08);border-radius:10px}
    .cell{border-radius:14px;overflow:hidden;border:1px solid rgba(255,255,255,.08);margin-top:12px}
    .cell-head{display:flex;justify-content:space-between;align-items:center;gap:12px;padding:10px 12px;background:rgba(255,255,255,.04);border-bottom:1px solid rgba(255,255,255,.06)}
    .cell-title{font-weight:600;font-size:.95rem;color:#eef5ff}
    .cell-run{appearance:none;border:0;border-radius:10px;background:var(--accent);color:#041022;font-weight:700;padding:8px 12px;cursor:pointer}
    .cell-run[disabled]{opacity:.6;cursor:not-allowed}
    .cell-body{display:grid;grid-template-columns:1fr}
    .cell textarea{font-family:var(--mono);width:100%;min-height:140px;resize:vertical;color:#e5efff;background:#0b1424;border:none;outline:none;padding:14px;line-height:1.4;font-size:.92rem}
    .cell-out{background:#07101f;border-top:1px solid rgba(255,255,255,.06);padding:12px;font-family:var(--mono);color:#d6e3ff;white-space:pre-wrap;overflow-x:auto}
    .cell-out img{max-width:100%;border-radius:10px;display:block;margin:12px 0}
    .cell-status{font-size:.8rem;color:var(--muted)}
    code,pre code{font-family:var(--mono);background:rgba(255,255,255,.05);padding:2px 6px;border-radius:6px}
    pre{background:#0b1424;border:1px solid rgba(255,255,255,.08);padding:14px;border-radius:12px;overflow:auto}
    .hr{height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.12),transparent);margin:24px 0}
    .tag{font-size:.7rem;opacity:.8;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);padding:4px 6px;border-radius:6px}
  </style>
</head>
<body>
  <div class="wrap">
    <header class="grid">
      <div>
        <h1>Avaliação de Empresas Jovens com Python, implementação prática do FCD</h1>
        <p class="tag">Standalone, Python no navegador com Pyodide, sem Colab</p>
      </div>
      <div class="notice">
        <strong>Como usar</strong>: cada bloco de código abaixo executa Python direto no navegador. Edite e clique em Rodar. Para gráficos, chame <code>showfig()</code>.
      </div>
    </header><section class="panel pad">
  <h2>Setup do ambiente Python</h2>
  <p>Valide os pacotes e o helper de gráficos.</p>
  <div class="cell" data-title="Setup do Pyodide">
    <div class="cell-head">
      <div class="cell-title">Python</div>
      <div class="cell-status" data-status>pronto</div>
      <button class="cell-run" data-run>Rodar</button>
    </div>
    <div class="cell-body">
      <div class="cell-code">

<textarea spellcheck="false">import sys, numpy as np
print("Python:", sys.version.split()[0])
print("NumPy:", np.__version__)

# Teste rápido de matplotlib + showfig
import matplotlib, matplotlib.pyplot as plt
print("Matplotlib:", matplotlib.__version__)
plt.plot([0,1,2],[0,1,0])
plt.title("Teste gráfico")
showfig()</textarea></div>
      <div class="cell-out" data-out></div>
    </div>
  </div>
</section>

<div class="hr"></div>

<section class="panel pad">
  <h2>Modelo base de FCD para empresas jovens</h2>
  <p>Exemplo didático, ajuste premissas conforme a sua aula.</p>

  <div class="cell" data-title="FCD básico">
    <div class="cell-head">
      <div class="cell-title">Python</div>
      <div class="cell-status" data-status>pronto</div>
      <button class="cell-run" data-run>Rodar</button>
    </div>
    <div class="cell-body">
      <div class="cell-code">

<textarea spellcheck="false"># Premissas simples
anos = 10
receita0 = 2.0e6
crec = [0.5,0.45,0.4,0.35,0.3,0.25,0.2,0.18,0.16,0.15]
margem_ebitda = [-0.30,-0.20,-0.10,0.05,0.10,0.15,0.18,0.20,0.22,0.25]
capex_sobre_receita = 0.06
nwc_sobre_receita = 0.08
aliquota = 0.0
wacc = 0.20

# Projeção
receita=[receita0]
for t in range(anos):
    receita.append(receita[-1]*(1+crec[t]))
receita=receita[1:]

import numpy as np, matplotlib.pyplot as plt

ebitda=[r*m for r,m in zip(receita,margem_ebitda)]
dep=[0.03*r for r in receita]
ebite=[e-d for e,d in zip(ebitda,dep)]

lucro_oper=[]; imposto=[]; prejuizo_acum=0.0
for e in ebite:
    base = e - max(prejuizo_acum,0)
    imp = max(base,0)*aliquota
    imposto.append(imp)
    lucro_oper.append(e-imp)
    prejuizo_acum += min(e,0)

nwc=[nwc_sobre_receita*r for r in receita]
capex=[capex_sobre_receita*r for r in receita]

fcl=[]
for t in range(anos):
    delta_nwc = nwc[t] - (nwc[t-1] if t>0 else 0)
    fcl.append(lucro_oper[t] + dep[t] - capex[t] - delta_nwc)

# Terminal perpetuidade
 g=0.04
 vt=fcl[-1]*(1+g)/(wacc-g)
fc_desc=[f/((1+wacc)**(t+1)) for t,f in enumerate(fcl)]
vt_desc=vt/((1+wacc)**anos)
valor_empre=sum(fc_desc)+vt_desc
print(f"Valor da firma, R$ {valor_empre:,.0f}")

plt.figure(figsize=(6.5,3.6))
plt.plot(range(1,anos+1),fcl,marker='o')
plt.title('Fluxo de Caixa Livre projetado')
plt.xlabel('Ano'); plt.ylabel('R$')
showfig()</textarea></div>
      <div class="cell-out" data-out></div>
    </div>
  </div>
</section>

<div class="hr"></div>

<section class="panel pad">
  <h2>Cenários e sensibilidade</h2>
  <div class="cell" data-title="Sensibilidade WACC × g">
    <div class="cell-head">
      <div class="cell-title">Python</div>
      <div class="cell-status" data-status>pronto</div>
      <button class="cell-run" data-run>Rodar</button>
    </div>
    <div class="cell-body">
      <div class="cell-code">

<textarea spellcheck="false">import numpy as np, matplotlib.pyplot as plt

def valor_firma_wacc_g(fcl, anos, wacc, g):
    vt = fcl[-1]*(1+g)/(wacc-g)
    fc_desc=[f/((1+wacc)**(t+1)) for t,f in enumerate(fcl)]
    vt_desc=vt/((1+wacc)**anos)
    return sum(fc_desc)+vt_desc

# Reusa fcl/anos da célula anterior se existirem, caso contrário cria dados fictícios
try:
    fcl
except NameError:
    fcl=[-1e6,-5e5, 2e5, 6e5, 1.1e6, 1.6e6, 2.0e6, 2.4e6, 2.7e6, 3.0e6]
    anos=len(fcl)

wacc_grid=np.linspace(0.14,0.28,8)
g_grid=np.linspace(0.01,0.05,5)
mat=np.zeros((len(wacc_grid),len(g_grid)))
for i,w in enumerate(wacc_grid):
    for j,g in enumerate(g_grid):
        mat[i,j]=valor_firma_wacc_g(fcl, anos, w, g)

plt.figure(figsize=(6,4))
plt.imshow(mat,origin='lower',aspect='auto')
plt.xticks(range(len(g_grid)),[f"{g:.2%}" for g in g_grid])
plt.yticks(range(len(wacc_grid)),[f"{w:.0%}" for w in wacc_grid])
plt.xlabel('g terminal'); plt.ylabel('WACC'); plt.title('Sensibilidade do Valor da Firma')
showfig()
print("Exemplo, WACC 22%, g 3%:", round(valor_firma_wacc_g(fcl, anos, 0.22, 0.03)))</textarea></div>
      <div class="cell-out" data-out></div>
    </div>
  </div>
</section>

<footer style="opacity:.75;margin-top:32px">
  <small>Esta versão executa Python localmente via Pyodide. O primeiro carregamento pode demorar um pouco.</small>
</footer>

  </div>  <!-- Loader seguro do Pyodide, sem await fora de função -->  <script>
    // Loader do Pyodide sem usar "await" fora de função nem dentro de onload
    const PYODIDE_INDEX_URL = "https://cdn.jsdelivr.net/pyodide/v0.25.1/full";
    let pyodideReady = null;

    function initPyodideSafe(){
      if (pyodideReady) return pyodideReady;
      pyodideReady = new Promise(function(resolve, reject){
        try {
          var s = document.createElement('script');
          s.src = PYODIDE_INDEX_URL + '/pyodide.js';
          s.onload = function(){
            // Encapsula toda a lógica assíncrona dentro de uma função async, chamada aqui sem await
            (function(){
              async function start(){
                try {
                  const p = await loadPyodide({ indexURL: PYODIDE_INDEX_URL, stdout: function(){}, stderr: function(){} });
                  // pré-carrega com retries
                  const need = ["numpy","matplotlib"];
                  for (let k=0; k<need.length; k++){
                    const name = need[k];
                    let ok=false, last=null;
                    for (let i=0;i<3 && !ok;i++){
                      try { await p.loadPackage(name); ok=true; }
                      catch(e){ last=e; await new Promise(r=>setTimeout(r,600*(i+1))); }
                    }
                    if(!ok){ reject(new Error('Falha ao carregar '+name+': '+(last && last.message ? last.message : last))); return; }
                  }
                  resolve(p);
                } catch(e){ reject(e); }
              }
              start();
            })();
          };
          s.onerror = function(){ reject(new Error('Não foi possível baixar pyodide.js')); };
          document.head.appendChild(s);
        } catch(e){ reject(e); }
      });
      return pyodideReady;
    }
  </script></body>
</html>
