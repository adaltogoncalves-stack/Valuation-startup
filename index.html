<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <title>Pyodide Teste</title>
  <style>
    body{background:#0b1220;color:#e8eefc;font-family:sans-serif;padding:20px}
    button{background:#4ea1ff;color:#041022;padding:10px 14px;border:0;border-radius:10px;font-weight:bold}
    pre{background:#0b1424;padding:12px;border-radius:10px}
  </style>
  <!-- carrega pyodide diretamente -->
  <script src="https://cdn.jsdelivr.net/pyodide/v0.25.1/full/pyodide.js"></script>
</head>
<body>
  <h1>Pyodide no GitHub Pages</h1>
  <p id="status">Carregando...</p>
  <button id="run" disabled>Rodar teste</button>
  <h3>Sa√≠da:</h3>
  <pre id="out">(aguardando)</pre>

  <script>
    let pyodide;

    async function main(){
      document.getElementById("status").textContent="Baixando pacotes...";
      pyodide = await loadPyodide({indexURL:"https://cdn.jsdelivr.net/pyodide/v0.25.1/full/"});
      await pyodide.loadPackage(["numpy","matplotlib"]);
      document.getElementById("status").textContent="Pronto!";
      document.getElementById("run").disabled=false;
    }

    main();

    document.getElementById("run").onclick=async()=>{
      document.getElementById("out").textContent="executando...";
      let code=`
import sys, numpy as np, matplotlib, matplotlib.pyplot as plt, io, base64
print("Python:", sys.version.split()[0])
print("NumPy:", np.__version__)
print("Matplotlib:", matplotlib.__version__)
x = np.linspace(0,6.28,200); y = np.sin(x)
plt.plot(x,y); plt.title("Seno")
buf=io.BytesIO(); plt.savefig(buf,format="png"); buf.seek(0)
"__IMG__"+base64.b64encode(buf.getvalue()).decode("ascii")
`;
      let result = await pyodide.runPythonAsync(code);
      let parts = result.split("__IMG__");
      let txt = parts[0];
      document.getElementById("out").textContent=txt;
      if(parts[1]){
        let img=new Image();
        img.src="data:image/png;base64,"+parts[1];
        img.style.maxWidth="100%";
        document.body.appendChild(img);
      }
    };
  </script>
</body>
</html>
